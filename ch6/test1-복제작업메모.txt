ì—°ìŠµí•˜ê¸°.

í˜„ìž¬ ë²„ì „ 8.0.4, í…ŒìŠ¤íŠ¸ í™•ì¸í•¨.

ê° êµ¬ì—­ í´ë” ë§Œë“¤ê¸°. 

mkdir c:\db\data\rs0-0
mkdir c:\db\data\rs0-1
mkdir c:\db\data\rs0-2

	1. C:/db/data/rs0-0
	2. C:/db/data/rs0-1
	3. C:/db/data/rs0-2

ëª…ë ¹ì–´ ì°½1 í˜„ì œ, 10.100.201.87
mongod --replSet rs0 --port 27018 --bind_ip 0.0.0.0 --dbpath /db/data/rs0-0

ëª…ë ¹ì–´ ì°½2
mongod --replSet rs0 --port 27019 --bind_ip localhost --dbpath /db/data/rs0-1

ëª…ë ¹ì–´ ì°½3
mongod --replSet rs0 --port 27020 --bind_ip localhost --dbpath /db/data/rs0-2

ëª…ë ¹ì–´ ì°½4 ì—¬ê¸°ì„œ ìƒˆë¡œ ì ‘ì† -> ì´ ëª…ë ¹ì–´ì°½ 4ê°œ.
ì¡°ìž¥. ìžê¸° ì„œë²„ 
mongo --port 27018

ëª…ë ¹ì–´_ë³€ê²½, 
mongosh --port 27018


rs.initiate(
{
_id : "rs0",
members: [
{_id:0, host:"localhost:27018"},
{_id:1, host:"localhost:27019"},
{_id:2, host:"localhost:27020"}
]
}
)

ì¡°íšŒ 
	- rs.status()
ë³µì œì„¸íŠ¸ ìƒì„¸ì •ë³´ ì¡°íšŒ.
ê°„ë‹¨ ì¡°íšŒ: db.isMaster()


í™•ì¸. 
ì‰˜ì—ì„œ, í”„ë¼ì´ë¨¸ë¦¬ì—ì„œ ê¸€ ì“°ê¸° ìƒ˜í”Œ í•˜ë‚˜, 
í™•ì¸ì€ ,27019, 27020,
1) ì‰˜ì—ì„œ, ê°€ëŠ¥
2) ì»´íŒŒìŠ¤ì—ë„ ê°€ëŠ¥, 

í”„ë¼ì´ë¨¸ë¦¬ì— ì ‘ì† í›„(ëª…ë ¹ì–´ì°½ 4ë²ˆì§¸ì—ì„œ ê³„ì† ìž‘ì—….)
-exit 
ëª½ê³ ë””ë¹„ ì„œë²„ ì ‘ì† ëª…ë ¹ì–´
-mongo --port 27019 
-mongosh --port 27019 
-
db.replicationTest2.insertOne({hello2: 'world2'})

ì„¸ì»¤ë”ë¦¬ì— ì ‘ì† í•´ì„œ 
-
db.replicationTest2.find()

ì—ëŸ¬ ë°œìƒ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¸ì»¨ë”ë¦¬ì—ì„œ ëª½ê³ ë””ë¹„ ì…¸ ì‚¬ìš© ëª»í•˜ê²Œ ì„¤ì •ë˜ì–´ ìžˆìŒ.
rs.slaveOk()

db.getMongo().setReadPref("primaryPreferred");

rs.stepDown();

ðŸ“Œ ì„¤ëª…
í˜„ìž¬ Primaryë¥¼ Step Down(Primary ì—­í• ì„ í¬ê¸°)í•˜ì—¬ Secondary ì¤‘ í•˜ë‚˜ê°€ ìŠ¹ê²©ë¨.
rs.freeze(0);

ðŸ“Œ ì„¤ëª…

íŠ¹ì • Secondaryê°€ Primaryë¡œ ìŠ¹ê²©ë˜ì§€ ì•Šë„ë¡ ë™ê²°.


ìœˆë„ìš° í™˜ê²½ ì„¤ì • íŒŒì¼ 
ì„¤ì¹˜ëœ ë””ë ‰í„°ë¦¬ /bin/mongod.cfg 
ì—¬ê¸°ì„œ ì ‘ì† í—ˆìš©í•  ip ë“± ì˜µì…˜ ì„¤ì •.

cfg = rs.conf();
cfg.members[0].priority = 2;
rs.reconfig(cfg);

use local
db.oplog.rs.find().limit(1).pretty()


rs.printSlaveReplicationInfo()


ìƒíƒœì¡°íšŒ.
rs.status()
ì„¸ì»¨ë”ë¦¬ì—ì„œ ëª…ë ¹ì–´ ì‹¤í–‰ì‹œ í•„ìš”.
rs.slaveOk()

ì¡°ì›ë“¤ í†µì‹  í™•ì¸ 
cmd -> ping 10.100.201.x